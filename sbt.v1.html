<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SBT è­‰æ›¸å¹³å° - æŠ€è¡“è¦åŠƒæ›¸ v1.4</title>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;600;700&family=Noto+Sans+TC:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Palette Definition */
            --bg-primary: #050508;
            --bg-secondary: #0f0f16;
            --bg-tertiary: #181824;
            
            --accent-blue: #2563eb;    /* Base Network / Tech */
            --accent-cyan: #06b6d4;    /* Frontend / Read Flow */
            --accent-purple: #9333ea;  /* Storage / Upload Flow */
            --accent-red: #ef4444;     /* Security / Relayer */
            --accent-gold: #fbbf24;    /* Value / Contract */
            --accent-green: #10b981;   /* Success / Low Cost */
            
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #475569;
            --border-color: #334155;
            
            --gradient-base: linear-gradient(135deg, #2563eb 0%, #06b6d4 100%);
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.7;
            min-height: 100vh;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 40px;
        }

        /* Header */
        header {
            padding: 60px 0 40px;
            border-bottom: 1px solid var(--border-color);
            position: relative;
        }

        .tag {
            display: inline-block;
            font-family: 'JetBrains Mono', monospace;
            font-size: 11px;
            text-transform: uppercase;
            letter-spacing: 2px;
            color: var(--accent-cyan);
            background: rgba(6, 182, 212, 0.1);
            padding: 6px 12px;
            border-radius: 4px;
            margin-bottom: 20px;
            border: 1px solid rgba(6, 182, 212, 0.3);
        }

        h1 {
            font-size: 42px;
            font-weight: 700;
            margin-bottom: 16px;
            background: var(--gradient-base);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .subtitle {
            font-size: 18px;
            color: var(--text-secondary);
            font-weight: 300;
        }

        /* Tech Stack Pills */
        .tech-stack {
            display: flex;
            gap: 12px;
            margin-top: 30px;
            flex-wrap: wrap;
        }

        .tech-pill {
            font-family: 'JetBrains Mono', monospace;
            font-size: 13px;
            padding: 8px 16px;
            border-radius: 20px;
            border: 1px solid var(--border-color);
            background: var(--bg-tertiary);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .tech-pill .dot { width: 8px; height: 8px; border-radius: 50%; }
        .tech-pill.base .dot { background: var(--accent-blue); }
        .tech-pill.arweave .dot { background: var(--accent-purple); }
        .tech-pill.security .dot { background: var(--accent-red); }

        /* Section */
        section {
            padding: 80px 0;
            border-bottom: 1px solid var(--border-color);
        }

        .section-header { margin-bottom: 50px; }
        .section-number {
            font-family: 'JetBrains Mono', monospace;
            font-size: 12px;
            color: var(--accent-cyan);
            letter-spacing: 3px;
            margin-bottom: 12px;
        }
        h2 { font-size: 32px; font-weight: 600; margin-bottom: 12px; }
        .section-desc { color: var(--text-secondary); font-size: 16px; margin-bottom: 8px; }

        /* Canvas Wrapper */
        .canvas-wrapper {
            background: var(--bg-secondary);
            border-radius: 24px;
            border: 2px solid var(--border-color);
            padding: 20px;
            margin-bottom: 40px;
            position: relative;
            box-shadow: 0 0 50px rgba(0, 0, 0, 0.5);
        }

        canvas { display: block; margin: 0 auto; max-width: 100%; }

        /* SBT Explainer Styles (Restored) */
        .sbt-explainer { margin-top: 60px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 16px; padding: 32px; position: relative; overflow: hidden; }
        .sbt-explainer::before { content: ''; position: absolute; top: 0; left: 0; right: 0; height: 3px; background: linear-gradient(90deg, var(--accent-blue), var(--accent-purple), var(--accent-gold)); }
        .sbt-header { margin-bottom: 30px; }
        .sbt-badge { display: inline-block; font-family: 'JetBrains Mono', monospace; font-size: 11px; letter-spacing: 2px; color: var(--accent-gold); background: rgba(251, 191, 36, 0.15); padding: 6px 12px; border-radius: 4px; border: 1px solid rgba(251, 191, 36, 0.3); margin-bottom: 12px; }
        .sbt-content { display: flex; flex-direction: column; gap: 40px; }
        
        /* Hierarchy Diagram */
        .sbt-hierarchy { display: flex; align-items: center; justify-content: center; gap: 20px; flex-wrap: wrap; padding: 40px 20px; background: rgba(255,255,255,0.02); border-radius: 12px; border: 1px solid var(--border-color); }
        .hierarchy-item { text-align: center; padding: 24px; border-radius: 12px; min-width: 220px; border: 2px solid transparent; transition: transform 0.3s ease; }
        .hierarchy-item:hover { transform: translateY(-5px); }
        .hierarchy-item.erc721 { background: rgba(37, 99, 235, 0.1); border-color: var(--accent-blue); }
        .hierarchy-item.nft { background: rgba(147, 51, 234, 0.1); border-color: var(--accent-purple); }
        .hierarchy-item.sbt { background: rgba(251, 191, 36, 0.1); border-color: var(--accent-gold); box-shadow: 0 0 20px rgba(251, 191, 36, 0.1); }
        
        .hierarchy-label { font-family: 'JetBrains Mono', monospace; font-size: 22px; font-weight: 700; margin-bottom: 8px; }
        .hierarchy-item.erc721 .hierarchy-label { color: var(--accent-blue); }
        .hierarchy-item.nft .hierarchy-label { color: var(--accent-purple); }
        .hierarchy-item.sbt .hierarchy-label { color: var(--accent-gold); }
        .hierarchy-desc { font-size: 15px; color: var(--text-primary); margin-bottom: 8px; font-weight: 600; }
        .hierarchy-detail { font-size: 13px; color: var(--text-secondary); }
        .hierarchy-connector { font-size: 32px; color: var(--text-muted); font-weight: 300; }
        
        /* Reason Cards */
        .sbt-reasons { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 24px; }
        .reason-card { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 12px; padding: 32px; text-align: center; transition: all 0.3s ease; }
        .reason-card:hover { border-color: var(--accent-gold); transform: translateY(-5px); }
        .reason-icon { font-size: 36px; margin-bottom: 20px; }
        .reason-title { font-size: 18px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary); }
        .reason-desc { font-size: 15px; color: var(--text-secondary); line-height: 1.6; }

        /* Cost Cards */
        .cost-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 24px;
        }

        .cost-card {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 28px;
            position: relative;
            overflow: hidden;
        }
        
        .cost-card::top { content: ''; height: 4px; width: 100%; position: absolute; top:0; left:0; }
        .cost-card.storage { border-top: 4px solid var(--accent-purple); }
        .cost-card.gas { border-top: 4px solid var(--accent-blue); }
        .cost-card.opex { border-top: 4px solid var(--accent-red); }

        .cost-label { font-size: 14px; color: var(--text-secondary); text-transform: uppercase; margin-bottom: 8px; }
        .cost-value { font-family: 'JetBrains Mono'; font-size: 32px; font-weight: 700; margin-bottom: 12px; color: var(--text-primary); }
        .cost-detail { font-size: 13px; color: var(--text-muted); font-family: 'JetBrains Mono'; }

        /* Warning Notes */
        .note-box {
            margin-top: 25px;
            padding: 20px;
            border-radius: 8px;
            font-size: 14px;
            line-height: 1.6;
        }
        .note-box.warning {
            background: rgba(239, 68, 68, 0.1);
            border-left: 4px solid var(--accent-red);
            color: #fca5a5;
        }
        .note-box.info {
            background: rgba(6, 182, 212, 0.1);
            border-left: 4px solid var(--accent-cyan);
            color: #a5f3fc;
        }
        .note-box strong { display: block; margin-bottom: 8px; font-weight: 700; }

        /* Timeline */
        .timeline { position: relative; padding-left: 40px; margin-top: 40px; }
        .timeline::before {
            content: ''; position: absolute; left: 8px; top: 0; bottom: 0; width: 2px;
            background: var(--border-color);
        }
        .timeline-item { position: relative; padding-bottom: 60px; }
        .timeline-marker {
            position: absolute; left: -40px; top: 5px; width: 18px; height: 18px;
            border-radius: 50%; background: var(--bg-primary); border: 3px solid var(--accent-blue);
            z-index: 1;
        }
        .timeline-title { font-size: 20px; font-weight: 600; margin-bottom: 16px; color: var(--text-primary); }
        .timeline-content {
            background: var(--bg-tertiary); border: 1px solid var(--border-color);
            border-radius: 12px; padding: 24px;
        }
        .task-list { list-style: none; }
        .task-list li {
            padding: 8px 0 8px 24px; position: relative; color: var(--text-secondary);
            border-bottom: 1px solid rgba(255,255,255,0.05);
        }
        .task-list li:last-child { border-bottom: none; }
        .task-list li::before {
            content: 'â€º'; position: absolute; left: 5px; color: var(--accent-cyan); font-weight: bold;
        }

        /* Footer */
        footer { padding: 40px 0; text-align: center; color: var(--text-muted); font-size: 13px; }

        @media (max-width: 900px) {
            .sbt-hierarchy { flex-direction: column; }
            .hierarchy-connector { transform: rotate(90deg); }
        }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <div class="tag">Technical Specification v1.4</div>
            <h1>SBT è­‰æ›¸å¹³å°æ¶æ§‹è¦åŠƒ</h1>
            <p class="subtitle">Base L2 Â· Arweave æ°¸ä¹…å­˜å„² Â· OpenZeppelin Defender å®‰å…¨ä¸­ç¹¼</p>
            
            <div class="tech-stack">
                <div class="tech-pill base"><span class="dot"></span>Base Network</div>
                <div class="tech-pill arweave"><span class="dot"></span>Arweave (Irys)</div>
                <div class="tech-pill security"><span class="dot"></span>OpenZeppelin Defender</div>
                <div class="tech-pill"><span class="dot" style="background:var(--text-primary)"></span>Next.js 14</div>
            </div>
        </header>

        <section>
            <div class="section-header">
                <div class="section-number">01 / ARCHITECTURE</div>
                <h2>ç³»çµ±æ¶æ§‹é‚è¼¯</h2>
                <p class="section-desc">ä¸‰å±¤å¼æ¶æ§‹ï¼šå‰ç«¯æ‡‰ç”¨å±¤ â†’ å€å¡Šéˆå±¤ â†’ æ°¸ä¹…å­˜å„²å±¤</p>
                <p class="section-desc">æ¡ç”¨ Relayer æ¨¡å¼ä¿è­·ç®¡ç†å“¡ç§é‘°ï¼Œç¢ºä¿è³‡æ–™æµèˆ‡åƒ¹å€¼æµçš„å®‰å…¨åˆ†é›¢ã€‚</p>
            </div>

            <div class="canvas-wrapper">
                <canvas id="archCanvas" width="1200" height="800"></canvas>
            </div>
            
            <p style="text-align: center; color: var(--text-secondary); font-size: 14px; margin-top: -20px;">
                *åœ–ä¾‹ï¼š<span style="color:var(--accent-cyan)">â–  å‰ç«¯/è®€å–</span> &nbsp; <span style="color:var(--accent-red)">â–  å®‰å…¨ä¸­ç¹¼ (Relayer)</span> &nbsp; <span style="color:var(--accent-blue)">â–  å€å¡Šéˆ (Base)</span> &nbsp; <span style="color:var(--accent-purple)">â–  å­˜å„² (Arweave)</span>
            </p>

            <div class="sbt-explainer">
                <div class="sbt-header">
                    <div class="sbt-badge">SOULBOUND TOKEN</div>
                    <h3>ç‚ºä»€éº¼ä½¿ç”¨ SBT éˆé­‚ç¶å®šä»£å¹£ï¼Ÿ</h3>
                </div>
                <div class="sbt-content">
                    <div class="sbt-hierarchy">
                        <div class="hierarchy-item erc721">
                            <div class="hierarchy-label">ERC-721</div>
                            <div class="hierarchy-desc">æŠ€è¡“æ¨™æº– (ä»‹é¢è¦ç¯„)</div>
                            <div class="hierarchy-detail">å®šç¾© NFT çš„åŸºæœ¬ä»‹é¢ï¼šownerOfã€transferFromã€tokenURI ç­‰</div>
                        </div>
                        <div class="hierarchy-connector">âŠƒ</div>
                        <div class="hierarchy-item nft">
                            <div class="hierarchy-label">NFT</div>
                            <div class="hierarchy-desc">éåŒè³ªåŒ–ä»£å¹£</div>
                            <div class="hierarchy-detail">åŸºæ–¼ ERC-721 çš„ä»£å¹£å¯¦ä½œï¼Œå¯è‡ªç”±è½‰ç§»äº¤æ˜“</div>
                        </div>
                        <div class="hierarchy-connector">âŠƒ</div>
                        <div class="hierarchy-item sbt">
                            <div class="hierarchy-label">SBT</div>
                            <div class="hierarchy-desc">éˆé­‚ç¶å®šä»£å¹£</div>
                            <div class="hierarchy-detail">ç¦ç”¨ transferï¼Œèˆ‡æŒæœ‰è€…èº«ä»½æ°¸ä¹…ç¶å®š</div>
                        </div>
                    </div>
                    <div class="sbt-reasons">
                        <div class="reason-card">
                            <div class="reason-icon">ğŸ“</div>
                            <div class="reason-title">è­‰æ›¸ä¸æ‡‰è¢«äº¤æ˜“</div>
                            <div class="reason-desc">å­¸æ­·ã€è³‡æ ¼è­‰æ›¸ä»£è¡¨å€‹äººæˆå°±ï¼Œè½‰è®“ç„¡æ„ç¾©ï¼Œå¿…é ˆç¢ºä¿å…¶æ­¸å±¬æ€§ã€‚</div>
                        </div>
                        <div class="reason-card">
                            <div class="reason-icon">ğŸ›¡ï¸</div>
                            <div class="reason-title">é˜²æ­¢å½é€ èˆ‡å†’ç”¨</div>
                            <div class="reason-desc">ç¶å®šç‰¹å®šéŒ¢åŒ…åœ°å€ï¼Œç„¡æ³•è¢«ä»–äººè³¼è²·å¾Œå†’å……æŒæœ‰è€…ã€‚</div>
                        </div>
                        <div class="reason-card">
                            <div class="reason-icon">âœ…</div>
                            <div class="reason-title">ç°¡åŒ–é©—è­‰é‚è¼¯</div>
                            <div class="reason-desc">é©—è­‰æ–¹åªéœ€ç¢ºèªã€Œæ­¤éŒ¢åŒ…åœ°å€æ˜¯å¦æŒæœ‰æ­¤åˆç´„ç™¼è¡Œçš„ Tokenã€å³å¯ã€‚</div>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section>
            <div class="section-header">
                <div class="section-number">02 / COST & OPERATIONS</div>
                <h2>æˆæœ¬èˆ‡é‹ç¶­è©•ä¼°</h2>
                <p class="section-desc">é™¤äº†å–®å¼µè­‰æ›¸çš„ Gas/Storage æˆæœ¬ï¼Œå¢åŠ äº† Relayer çš„é‹ç¶­é ç®—ã€‚</p>
            </div>

            <div class="cost-grid">
                <div class="cost-card gas">
                    <div class="cost-label">Base Gas Fee</div>
                    <div class="cost-value">~$0.005 / å¼µ</div>
                    <div class="cost-detail">Mint äº¤æ˜“è²» (æµ®å‹•)</div>
                </div>
                <div class="cost-card storage">
                    <div class="cost-label">Arweave å­˜å„²</div>
                    <div class="cost-value">~$0.004 / å¼µ</div>
                    <div class="cost-detail">500KB åœ–æª” + JSON</div>
                </div>
                <div class="cost-card opex">
                    <div class="cost-label">Relayer é‹ç¶­ (OPEX)</div>
                    <div class="cost-value">$0 - $500 / æœˆ</div>
                    <div class="cost-detail">å–æ±ºæ–¼ç™¼æ”¾è¦æ¨¡ (è¦‹ä¸‹æ–¹èªªæ˜)</div>
                </div>
            </div>

            <div class="note-box info">
                <strong>ğŸ’¡ OpenZeppelin Defender è²»ç”¨èªªæ˜</strong>
                <ul>
                    <li><strong>MVP / æ¸¬è©¦éšæ®µ (Phase 3)ï¼š</strong> ä½¿ç”¨ <strong>Community Plan (å…è²»)</strong>ã€‚é©åˆé–‹ç™¼æ¸¬è©¦åŠå°è¦æ¨¡ç™¼æ”¾ï¼ˆå¦‚æ¯é€± < 100 å¼µï¼‰ï¼Œä½†æœ‰ API é€Ÿç‡é™åˆ¶ã€‚</li>
                    <li><strong>ç”Ÿç”¢ / è¦æ¨¡åŒ–éšæ®µ (Phase 4)ï¼š</strong> è‹¥æ¥­å‹™æ“´å¼µéœ€å¤§é‡ç™¼è­‰ï¼ˆå¦‚ > 1000 å¼µ/æœˆï¼‰æˆ–è¦æ±‚é«˜ SLAï¼Œéœ€å‡ç´šè‡³ <strong>Professional Plan</strong> (é ä¼°ç´„ $300-$500/æœˆ)ã€‚æ­¤ç‚ºå›ºå®šé‹ç¶­æˆæœ¬ã€‚</li>
                </ul>
            </div>

            <div class="note-box warning">
                <strong>âš ï¸ é‡è¦éš±ç§èˆ‡åˆè¦æç¤º (GDPR)</strong>
                Arweave ç‚ºã€Œæ°¸ä¹…å…¬é–‹ã€ç¶²çµ¡ï¼Œè³‡æ–™ä¸€æ—¦ä¸Šå‚³ç„¡æ³•åˆªé™¤ã€‚
                <br />åœ¨è­‰æ›¸ Metadata æˆ–åœ–ç‰‡ä¸­åŒ…å«æ•æ„Ÿå€‹è³‡ (PII)ï¼Œå¦‚èº«åˆ†è­‰å­—è™Ÿã€é›»è©±ã€åœ°å€ã€‚å»ºè­°åƒ…ä¸Šå‚³å§“åï¼Œæ•æ„Ÿè³‡æ–™æ‡‰ä¿ç•™åœ¨å‚³çµ±è³‡æ–™åº«ä¸­é€²è¡Œéˆä¸‹é©—è­‰ã€‚
            </div>
        </section>

        <section>
            <div class="section-header">
                <div class="section-number">03 / IMPLEMENTATION PLAN</div>
                <h2>å¯¦æ–½è¨ˆåŠƒ</h2>
            </div>

            <div class="timeline">
                <div class="timeline-item">
                    <div class="timeline-marker"></div>
                    <div class="timeline-title">Phase 1: æ™ºèƒ½åˆç´„é–‹ç™¼ (Solidity)</div>
                    <div class="timeline-content">
                        <ul class="task-list">
                            <li>é–‹ç™¼ Soulbound ERC-721 åˆç´„ (è¦†å¯« transfer å‡½æ•¸ä»¥ç¦æ­¢è½‰ç§»)</li>
                            <li>åŠ å…¥ AccessControl (åƒ…å…è¨± Relayer æˆ– Admin åœ°å€ Mint)</li>
                            <li>éƒ¨ç½²è‡³ Base Sepolia æ¸¬è©¦ç¶²ä¸¦é©—è­‰åŸå§‹ç¢¼</li>
                        </ul>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-marker" style="border-color: var(--accent-purple)"></div>
                    <div class="timeline-title">Phase 2: å­˜å„²å±¤æ•´åˆ (Arweave)</div>
                    <div class="timeline-content">
                        <ul class="task-list">
                            <li>æ•´åˆ Irys SDK (åŸ Bundlr) é€²è¡Œæª”æ¡ˆä¸Šå‚³</li>
                            <li>è¨­è¨ˆ Metadata JSON çµæ§‹ (ç¢ºä¿ç„¡ PII)</li>
                            <li>å¯¦ä½œåœ–ç‰‡ç”Ÿæˆé‚è¼¯ (Canvas/Satori) ä¸¦ä¸Šå‚³è‡³ Arweave</li>
                        </ul>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-marker" style="border-color: var(--accent-red)"></div>
                    <div class="timeline-title">Phase 3: å®‰å…¨ä¸­ç¹¼èˆ‡å¾Œç«¯ (Next.js + Defender)</div>
                    <div class="timeline-content">
                        <ul class="task-list">
                            <li><strong>è¨­ç½® OpenZeppelin Defenderï¼š</strong> å»ºç«‹ Relayerï¼Œç²å– API Key èˆ‡ Secretã€‚</li>
                            <li><strong>Next.js API Routeï¼š</strong> é–‹ç™¼ `/api/issue`ï¼Œå¾Œç«¯é©—è­‰æ¬Šé™å¾Œï¼Œå‘¼å« Defender API ç™¼é€äº¤æ˜“ã€‚</li>
                            <li><strong>å®‰å…¨æ€§é…ç½®ï¼š</strong> ç¢ºä¿ Relayer API Key åƒ…åœ¨ Vercel å¾Œç«¯ç’°å¢ƒè®Šæ•¸ä¸­å¯è¦‹ï¼Œçµ•ä¸æš´éœ²æ–¼å‰ç«¯ã€‚</li>
                        </ul>
                    </div>
                </div>

                <div class="timeline-item">
                    <div class="timeline-marker" style="border-color: var(--accent-green)"></div>
                    <div class="timeline-title">Phase 4: ä¸Šç·šèˆ‡ç›£æ§</div>
                    <div class="timeline-content">
                        <ul class="task-list">
                            <li>éƒ¨ç½²è‡³ Base Mainnet</li>
                            <li>ç‚º Defender Relayer å……å€¼å°‘é‡ ETH (Base) ä½œç‚º Gas</li>
                            <li>ç«¯åˆ°ç«¯æ¸¬è©¦ï¼šç™¼è­‰ â†’ éˆä¸Šç¢ºèª â†’ å‰ç«¯é¡¯ç¤º</li>
                            <li>å»ºç«‹ç›£æ§ Dashboard (è¿½è¹¤ Relayer é¤˜é¡èˆ‡äº¤æ˜“æˆåŠŸç‡)</li>
                        </ul>
                    </div>
                </div>
            </div>
        </section>

        <footer>
            <p>SBT Certificate Platform Tech Spec v1.4</p>
            <p>Designed for AI Director Context Â· 2025</p>
        </footer>
    </div>

    <script>
        // ==========================================
        // æ¸…æ™°ç‰ˆæ¶æ§‹åœ–ç¹ªè£½é‚è¼¯ (Canvas) v1.4
        // ä¿®æ­£ï¼šå°‡å…­é‚Šå½¢ç¯€é»èƒŒæ™¯æ”¹ç‚ºåŠé€æ˜ï¼Œè§£æ±ºé®æ“‹å•é¡Œ
        // ==========================================
        const canvas = document.getElementById('archCanvas');
        const ctx = canvas.getContext('2d');

        // é…è‰²å®šç¾©
        const colors = {
            bg: '#0f0f16',
            nodeBgTransparent: 'rgba(15, 15, 22, 0.85)', // FIX: åŠé€æ˜èƒŒæ™¯è‰²
            cardBg: '#1e1e2e',
            border: '#334155',
            blue: '#3b82f6',    // Base
            purple: '#a855f7',  // Arweave
            cyan: '#06b6d4',    // Frontend
            red: '#ef4444',     // Relayer/Security
            gold: '#fbbf24',    // Contract
            text: '#f1f5f9',
            textSub: '#94a3b8'
        };

        // ç¹ªåœ–è¼”åŠ©å‡½æ•¸ï¼šåœ“è§’çŸ©å½¢ (ç¯€é»ç”¨)
        function drawCard(ctx, x, y, w, h, color, title, subtitle) {
            ctx.beginPath();
            ctx.roundRect(x, y, w, h, 12);
            ctx.fillStyle = colors.cardBg;
            ctx.fill();
            
            // é‚Šæ¡†èˆ‡å…‰æšˆ
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.shadowColor = color;
            ctx.shadowBlur = 10;
            ctx.stroke();
            ctx.shadowBlur = 0; // é‡ç½®

            // é ‚éƒ¨è‰²æ¢
            ctx.beginPath();
            ctx.roundRect(x, y, w, 4, {upperLeft:12, upperRight:12});
            ctx.fillStyle = color;
            ctx.fill();

            // æ–‡å­—
            ctx.fillStyle = colors.text;
            ctx.font = 'bold 16px "Noto Sans TC"';
            ctx.textAlign = 'center';
            ctx.fillText(title, x + w/2, y + 40);

            if (subtitle) {
                ctx.fillStyle = colors.textSub;
                ctx.font = '12px "JetBrains Mono"';
                ctx.fillText(subtitle, x + w/2, y + 60);
            }
        }

        // ç¹ªåœ–è¼”åŠ©å‡½æ•¸ï¼šèƒŒæ™¯å€åŸŸ (Zone) - ç”¨æ–¼ç¹ªè£½åº•å±¤å€å¡Š
        function drawZone(ctx, x, y, w, h, bgColor, borderColor, label) {
            ctx.beginPath();
            ctx.roundRect(x, y, w, h, 16);
            ctx.fillStyle = bgColor;
            ctx.fill();
            
            ctx.strokeStyle = borderColor;
            ctx.lineWidth = 1;
            ctx.setLineDash([5, 5]);
            ctx.stroke();
            ctx.setLineDash([]); // Reset

            // Zone Label
            ctx.fillStyle = borderColor;
            ctx.font = 'bold 14px "Noto Sans TC"';
            ctx.textAlign = 'center';
            ctx.fillText(label, x + w/2, y + 30);
        }

        // ç¹ªåœ–è¼”åŠ©å‡½æ•¸ï¼šå…­é‚Šå½¢ (åŠŸèƒ½ç¯€é»)
        function drawHex(ctx, x, y, size, color, label) {
            ctx.beginPath();
            for (let i = 0; i < 6; i++) {
                ctx.lineTo(x + size * Math.cos(Math.PI/3 * i), y + size * Math.sin(Math.PI/3 * i));
            }
            ctx.closePath();
            // FIX: ä½¿ç”¨åŠé€æ˜èƒŒæ™¯
            ctx.fillStyle = colors.nodeBgTransparent;
            ctx.fill();
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            ctx.stroke();

            // Label
            ctx.fillStyle = colors.text;
            ctx.font = '12px "JetBrains Mono"';
            ctx.textAlign = 'center';
            // è™•ç†æ›è¡Œ
            const lines = label.split('\n');
            lines.forEach((line, i) => {
                ctx.fillText(line, x, y - ((lines.length-1)*10) + 5 + (i * 15));
            });
        }

        // ç¹ªåœ–è¼”åŠ©å‡½æ•¸ï¼šé€£æ¥ç·š
        function drawLink(ctx, x1, y1, x2, y2, color, label, dashed = false) {
            ctx.beginPath();
            ctx.moveTo(x1, y1);
            // è²èŒ²æ›²ç·š
            const cp1x = x1 + (x2 - x1) / 2;
            const cp2x = x1 + (x2 - x1) / 2;
            ctx.bezierCurveTo(cp1x, y1, cp2x, y2, x2, y2);
            
            ctx.strokeStyle = color;
            ctx.lineWidth = 2;
            if (dashed) ctx.setLineDash([8, 8]);
            else ctx.setLineDash([]);
            ctx.stroke();
            ctx.setLineDash([]);

            // ç®­é ­ (åœ“é»)
            ctx.beginPath();
            ctx.arc(x2, y2, 4, 0, Math.PI*2);
            ctx.fillStyle = color;
            ctx.fill();

            // æ¨™ç±¤
            if (label) {
                const mx = (x1 + x2) / 2;
                const my = (y1 + y2) / 2;
                ctx.fillStyle = colors.bg;
                const textW = ctx.measureText(label).width + 10;
                ctx.fillRect(mx - textW/2, my - 10, textW, 20);
                ctx.fillStyle = color;
                ctx.font = 'bold 11px "JetBrains Mono"';
                ctx.textAlign = 'center';
                ctx.fillText(label, mx, my + 4);
            }
        }

        // ä¸»ç¹ªåœ–é‚è¼¯
        function draw() {
            ctx.clearRect(0, 0, 1200, 800);
            
            // --- 1. èƒŒæ™¯ç¶²æ ¼ ---
            ctx.strokeStyle = '#1e1e2e';
            ctx.lineWidth = 1;
            ctx.beginPath();
            for(let i=0; i<1200; i+=40) { ctx.moveTo(i,0); ctx.lineTo(i,800); }
            for(let i=0; i<800; i+=40) { ctx.moveTo(0,i); ctx.lineTo(1200,i); }
            ctx.stroke();

            // --- 2. ç¹ªè£½èƒŒæ™¯å€åŸŸ (Zones) ---
            // Base Network Zone (Opacity 0.05)
            drawZone(ctx, 280, 300, 450, 180, 'rgba(59, 130, 246, 0.05)', colors.blue, "Base Network");
            // Arweave Zone (Opacity 0.05)
            drawZone(ctx, 280, 560, 550, 160, 'rgba(168, 85, 247, 0.05)', colors.purple, "Arweave Permaweb");


            // --- 3. å€åŸŸæ–‡å­—æ¨™ç¤º ---
            ctx.fillStyle = colors.textSub;
            ctx.font = 'bold 14px "JetBrains Mono"';
            ctx.textAlign = 'left';
            ctx.fillText("LAYER 1: FRONTEND & API", 50, 50);
            ctx.fillText("SECURITY BRIDGE", 900, 50);
            ctx.fillText("LAYER 2: BLOCKCHAIN", 50, 320);
            ctx.fillText("LAYER 3: STORAGE", 50, 580);

            // ================= é…ç½®ç¯€é»åº§æ¨™ =================
            // Layer 1
            const adminX = 200, adminY = 100;
            const publicX = 500, publicY = 100;
            const apiX = 750, apiY = 100; // API Route
            
            // Bridge (Relayer)
            const relayerX = 950, relayerY = 200; // Defender

            // Layer 2
            const rpcX = 350, rpcY = 400;
            const contractX = 600, contractY = 400;

            // Layer 3
            const gatewayX = 350, gatewayY = 650;
            const storageX = 700, storageY = 650;

            // ================= 4. ç¹ªè£½é€£ç·š =================

            // 1. Upload Flow: Admin -> API -> Gateway -> Storage
            drawLink(ctx, adminX + 90, adminY + 80, apiX, apiY + 50, colors.cyan, "1. Upload Req");
            drawLink(ctx, apiX, apiY + 50, gatewayX, gatewayY - 40, colors.purple, "2. Upload File", false);
            drawLink(ctx, gatewayX + 50, gatewayY, storageX - 70, storageY, colors.purple, "Pin");

            // 2. Mint Flow: API -> Relayer -> RPC -> Contract
            // é—œéµï¼šé€™æ¢ç·šæœƒè·¨é Base Network èƒŒæ™¯å€ï¼Œç¾åœ¨èƒŒæ™¯å€å·²å…ˆç¹ªè£½ï¼Œç·šæ¢æœƒé¡¯ç¤ºåœ¨ä¸Šæ–¹
            drawLink(ctx, apiX + 50, apiY + 50, relayerX, relayerY - 40, colors.red, "3. Secure Mint Req");
            drawLink(ctx, relayerX, relayerY + 40, rpcX + 50, rpcY - 40, colors.red, "4. Signed Tx");
            // FIX: é€™æ¢ç·šç¾åœ¨æœƒè¢«åŠé€æ˜çš„åˆç´„ç¯€é»è“‹ä½ï¼Œä½†ä»ç„¶å¯è¦‹
            drawLink(ctx, rpcX + 70, rpcY, contractX - 35, contractY, colors.blue, "5. Exec");

            // 3. Token URI Link: Contract -> Storage
            drawLink(ctx, contractX, contractY + 35, storageX, storageY - 40, colors.gold, "tokenURI", true);

            // 4. Verify Flow: Public -> Contract & Public -> Storage
            drawLink(ctx, publicX, publicY + 80, contractX, contractY - 35, colors.cyan, "Read Owner");
            drawLink(ctx, publicX + 50, publicY + 80, storageX, storageY - 40, colors.cyan, "Read Img");


            // ================= 5. ç¹ªè£½ç¯€é» (Nodes) =================
            // æœ€å¾Œç¹ªè£½ç¯€é»ï¼Œç¢ºä¿ç¯€é»è“‹åœ¨ç·šæ¢ä¸Šï¼Œä½†å…­é‚Šå½¢æ˜¯åŠé€æ˜çš„

            // Layer 1 Nodes
            drawCard(ctx, adminX, adminY, 180, 80, colors.cyan, "Admin Dashboard", "Next.js");
            drawCard(ctx, publicX, publicY, 180, 80, colors.cyan, "Public Verify", "Next.js");
            drawHex(ctx, apiX + 25, apiY + 40, 50, colors.cyan, "API Route\n/api/issue");

            // Bridge Node (Defender) - Highlighted
            drawCard(ctx, relayerX - 50, relayerY, 200, 90, colors.red, "ğŸ›¡ï¸ OZ Defender", "Relayer & HSM");

            // Layer 2 Nodes (Specific)
            drawCard(ctx, rpcX, rpcY - 30, 140, 60, colors.blue, "RPC Node", "Infura/Alchemy");
            // FIX: é€™å€‹ç¯€é»ç¾åœ¨æ˜¯åŠé€æ˜çš„
            drawHex(ctx, contractX, contractY, 70, colors.gold, "SBT Contract\nERC-721\n(No Transfer)");

            // Layer 3 Nodes (Specific)
            drawHex(ctx, gatewayX, gatewayY, 50, colors.purple, "Irys\nGateway");
            drawCard(ctx, storageX, storageY - 30, 160, 70, colors.purple, "Data Blocks", "Image & JSON");

        }

        // åŸ·è¡Œç¹ªåœ–
        draw();
        
        // RWD
        window.addEventListener('resize', () => {
             const wrapper = document.querySelector('.canvas-wrapper');
             const scale = Math.min(1, (wrapper.offsetWidth - 40) / 1200);
             canvas.style.transform = `scale(${scale})`;
             canvas.style.transformOrigin = 'top left';
             wrapper.style.height = (800 * scale + 40) + 'px';
        });
        window.dispatchEvent(new Event('resize')); // Init
    </script>
</body>
</html>