<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>昆蟲奇遇記</title>
    <!-- 引入 Google Fonts Noto Serif TC 以確保印刷時有漂亮的襯線字體 -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet">
    
    <style>
        /* 全局設定與變數 */
        :root {
            --font-main: 'Noto Serif TC', 'Songti TC', 'PMingLiU', 'MingLiU', serif;
            /* 預設亮色主題 */
            --bg-color: #eef2f5;       /* 瀏覽器背景 */
            --paper-color: #ffffff;    /* 紙張背景 */
            --text-color: #1a1a1a;     /* 文字顏色 */
            --accent-color: #8b4513;   /* 裝飾色（首字下沉等） */
            --shadow-color: rgba(0, 0, 0, 0.08);
            /* 將預設字體從 12pt 改為 14pt，更適合閱讀 */
            --font-size-base: 14pt;
        }

        /* 羊皮紙護眼主題 */
        [data-theme="sepia"] {
            --bg-color: #f0e6d2;
            --paper-color: #fbf0d9;
            --text-color: #5b4636;
            --accent-color: #8b5a2b;
            --shadow-color: rgba(91, 70, 54, 0.1);
        }

        /* 暗黑夜間主題 */
        [data-theme="dark"] {
            --bg-color: #121212;
            --paper-color: #1e1e1e;
            --text-color: #c0c0c0;
            --accent-color: #a89f91;
            --shadow-color: rgba(0, 0, 0, 0.5);
        }

        body {
            margin: 0;
            padding: 40px 20px;
            background-color: var(--bg-color);
            font-family: var(--font-main);
            color: var(--text-color);
            -webkit-font-smoothing: antialiased;
            transition: background-color 0.4s ease, color 0.4s ease;
        }

        /* 閱讀進度條 */
        #progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            height: 4px;
            background: linear-gradient(90deg, #4a90e2, #50e3c2);
            width: 0%;
            z-index: 1001;
            transition: width 0.1s;
        }

        /* 模擬 A4 紙張的容器 */
        .page {
            width: 210mm;
            min-height: 297mm;
            padding: 25mm;
            margin: 0 auto;
            background-color: var(--paper-color);
            box-shadow: 0 10px 30px var(--shadow-color);
            box-sizing: border-box;
            position: relative;
            transition: background-color 0.4s ease, box-shadow 0.4s ease;
            /* 讓紙張邊緣稍微圓潤一點，螢幕閱讀更舒服 */
            border-radius: 4px; 
        }

        /* 標題樣式 */
        h1 {
            text-align: center;
            font-size: 2.2em;
            font-weight: 700;
            margin-bottom: 0.5em;
            letter-spacing: 4px;
            color: var(--text-color);
        }

        /* 作者與日期資訊樣式 */
        .meta-info {
            text-align: center;
            margin-bottom: 3em;
            font-size: 1em;
            opacity: 0.8;
            font-style: italic;
            border-bottom: 1px solid var(--accent-color);
            display: inline-block;
            padding-bottom: 10px;
            /* 讓這個區塊置中 */
            position: relative;
            left: 50%;
            transform: translateX(-50%);
        }

        .meta-info p {
            margin: 0;
            text-indent: 0;
            padding: 2px 10px;
        }

        /* 內文排版核心 */
        .content {
            font-size: var(--font-size-base);
            line-height: 1.8;
            text-align: justify;
            text-justify: inter-ideograph;
        }

        /* 段落樣式 */
        p {
            margin-bottom: 0;
            margin-top: 0;
            padding-bottom: 1.2em;
            text-indent: 2em;
        }

        /* 首字下沉設計 (Drop Cap) */
        .content > p:first-of-type::first-letter {
            font-size: 3.8em;
            float: left;
            line-height: 0.85;
            margin-right: 0.15em;
            margin-left: -0.1em; /* 稍微修正視覺對齊 */
            color: var(--accent-color);
            font-weight: bold;
            font-family: serif; /* 確保使用襯線體 */
        }

        /* 螢幕閱讀工具列 */
        .toolbar {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            padding: 10px 15px;
            border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            display: flex;
            align-items: center;
            gap: 15px;
            z-index: 1000;
            font-family: sans-serif;
            font-size: 14px;
            border: 1px solid rgba(0,0,0,0.05);
            transition: opacity 0.3s;
        }

        /* 暗色模式下的工具列適配 */
        [data-theme="dark"] .toolbar {
            background-color: rgba(50, 50, 50, 0.8);
            border-color: rgba(255,255,255,0.1);
            color: #fff;
        }

        .toolbar button {
            border: none;
            background: none;
            cursor: pointer;
            padding: 5px;
            border-radius: 50%;
            transition: transform 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 16px;
        }

        .toolbar button:hover {
            transform: scale(1.1);
            background-color: rgba(0,0,0,0.05);
        }

        [data-theme="dark"] .toolbar button:hover {
            background-color: rgba(255,255,255,0.1);
        }
        
        /* 工具列分隔線 */
        .divider {
            width: 1px;
            height: 20px;
            background-color: #ccc;
        }

        /* RWD 手機適配 */
        @media screen and (max-width: 220mm) {
            .page {
                width: 100%;
                min-height: auto;
                padding: 40px 25px;
                box-shadow: none;
            }
            body {
                padding: 0;
            }
            .toolbar {
                top: auto;
                bottom: 20px;
                right: 50%;
                transform: translateX(50%);
            }
        }

        /* =========================================
           列印專用樣式 (@media print)
           這裡的設定會覆蓋上面的樣式，確保列印輸出乾淨
           ========================================= */
        @media print {
            /* 修正：強制將全域文字顏色變數改為純黑 #000000 */
            :root {
                --text-color: #000000 !important;
            }

            /* 混合策略：上方使用物理邊距，其他方向歸零 */
            @page {
                size: A4;
                /* 上方給予 20mm 的物理留白，保證每一頁開頭都有呼吸空間 */
                margin: 20mm 0 0 0; 
            }

            /* 隱藏螢幕專用元素 */
            .toolbar, #progress-bar {
                display: none !important;
            }

            body {
                /* 修正：背景改為純白，比 none 更安全，防止透出螢幕的深色背景 */
                background-color: #ffffff !important;
                margin: 0;
                padding: 0;
                color: #000000 !important;
            }
            
            .page {
                width: 100%;
                height: auto;
                margin: 0;
                
                /* 這裡設定內容的內距 */
                /* 上：0 (因為 @page 已經給了 20mm) */
                /* 左右：15mm (維持您覺得不錯的寬度) */
                /* 下：25mm (預留空間給頁尾) */
                padding: 0 15mm 25mm 15mm; 
                
                box-shadow: none;
                border: none;
                border-radius: 0;
                
                /* 修正：背景改為純白 #ffffff */
                /* 這是最安全的設定，確保列印出來底色乾淨 */
                /* 由於下方的 footer 有 z-index: 9999，所以不會被這個白色背景蓋住 */
                background-color: #ffffff !important;
                
                /* 強制容器內所有文字純黑 */
                color: #000000 !important;
            }

            h1 {
                margin-top: 0;
                padding-top: 10px; 
                color: #000000 !important;
            }

            .content > p:first-of-type::first-letter {
                color: #000000 !important;
            }

            .meta-info {
                border-bottom: 1px solid #000000;
                color: #000000 !important;
            }

            /* 頁尾設定 */
            .print-footer {
                display: block !important;
                position: fixed;
                bottom: 8mm; 
                left: 0;
                right: 0;
                text-align: center;
                font-size: 9pt; 
                font-family: var(--font-main);
                color: #000000 !important; 
                background-color: transparent;
                /* 關鍵：最高的層級，確保它浮在白色背景之上 */
                z-index: 9999;
            }

            /* 強制背景列印設定 */
            * {
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
                text-shadow: none !important;
            }
        }

        /* 螢幕上隱藏這個列印頁尾 */
        .print-footer {
            display: none;
        }
    </style>
</head>
<body>

    <!-- 閱讀進度條 -->
    <div id="progress-bar"></div>

    <!-- 懸浮工具列 -->
    <div class="toolbar">
        <span title="調整字體大小" style="font-size: 12px; opacity: 0.6;">Aa</span>
        <button onclick="changeFontSize(-1)" title="縮小字體">－</button>
        <button onclick="changeFontSize(1)" title="放大字體">＋</button>
        <div class="divider"></div>
        <button onclick="setTheme('light')" title="亮色模式" style="background-color: #fff; border: 1px solid #ddd; width: 20px; height: 20px;"></button>
        <button onclick="setTheme('sepia')" title="羊皮紙護眼" style="background-color: #fbf0d9; border: 1px solid #e0d0b0; width: 20px; height: 20px;"></button>
        <button onclick="setTheme('dark')" title="暗黑模式" style="background-color: #1e1e1e; border: 1px solid #444; width: 20px; height: 20px;"></button>
        <div class="divider"></div>
        <!-- 將圖示改為「復原」箭頭 (Undo/Return)，更符合撤銷變更的概念 -->
        <button onclick="resetDefaults()" title="恢復預設值" style="font-size: 18px;">↩</button>
        <button onclick="window.print()" title="列印本文" style="font-size: 18px;">🖨️</button>
    </div>

    <!-- 新增：列印時會出現在每一頁下方的書名 -->
    <div class="print-footer">
        — 昆蟲奇遇記 —
    </div>

    <div class="page">
        <h1>昆蟲奇遇記</h1>
        
        <div class="meta-info">
            <p>作者：許哲安</p>
            <p>日期：2025/11/29</p>
        </div>

        <div class="content">
            <p>維金斯是一隻全身像彩色的鑽石一樣閃閃發光，十分耀眼的彩虹鍬形蟲，他的夢想是從不知名的喜劇演員變成帥氣的昆蟲間諜，打敗壞蟲，拯救受害的昆蟲，雖然維金斯的觀察力敏銳，而且很有責任感，但他就是缺乏自信。</p>

            <p>有一天，維金斯在一家大飯店的劇院表演完後，突然聽見背後突然傳來一陣低沈的聲音：</p>
            
            <p>「這位先生您好，我是昆蟲間諜聯盟的枯葉螽斯詹姆士，請問您是否有意願成為昆蟲間諜呢？我們正在四處找人，我看得出來您非常有潛力。」</p>
            
            <p>詹姆士很有經驗，也很厲害，曾經打敗了許多惡劣的壞蟲，像是力氣大的獨角仙強盜馬修和傑夫，還有瘋狂的螳螂殺蟲魔蓋瑞。</p>
            
            <p>維金斯愣了一下，並說：</p>
            
            <p>「昆⋯⋯昆蟲間諜？當⋯⋯當然可以，但請問我的潛力是什麼？」</p>
            
            <p>詹姆士微笑：</p>
            
            <p>「等等你就會知道了。」</p>
            
            <p>雖然維金斯答應了，但他還是沒有自信，這時，維金斯注意到觀眾席在他們談話的途中少了三位觀眾，他趕緊叫住詹姆士，並告訴詹姆士他的發現，他們討論，並調了現場監視器後，維金斯鼓起勇氣斷定是那位穿著優雅純黑色禮服，還帶著像貓一樣柔軟的鮮紅色圍巾的美麗螢火蟲被兩隻像石墨一樣黑的兇悍大獨角仙帶走，必須去救她。</p>
            
            <p>他們經過努力找到螢火蟲小姐的去向，並挑戰了很多像在挑戰自己體能極限的關卡後找到了螢火蟲小姐，但螢火蟲小姐卻不高興的噘起嘴 巴：</p>
            
            <p>「我才不是被綁架！我是和我的朋友在玩密室逃脫遊戲而已！」</p>
            
            <p>維金斯微微張開嘴巴：</p>
            
            <p>「啊，原來是這樣，真的很抱歉！」</p>
            
            <p>雖然詹姆士不斷地安慰他，但維金斯因為這件事，又失去了許多自信。</p>
            
            <p>幾天後，維金斯的朋友告訴他詹姆士和螢火蟲小姐在公園清澈的池塘附近被抓走了，只知道兇手是兩隻披著深灰色披風的高大昆蟲，而且是往那天那家密室逃脫店面的方向走，維金斯為了救詹姆士與螢火蟲小姐，飛到了目前被警方封鎖的密室逃脫店面附近。</p>
            
            <p>當維金斯剛剛進入被封鎖的區域，小心翼翼地躲進了最近的灌木叢，準備露出雙眼偷看，這時他聽見了低沉但興奮說話聲：</p>
            
            <p>「哈！那個叫維金斯的真的被我騙了，而且我們順利得到龐大的財產啦！太棒了！」</p>
            
            <p>沒想到之前那兩隻大獨角仙正和正在竊笑的詹姆士高興的打開了一座地下室，嘲笑被關在裡面的螢火蟲小姐，維金斯實在是太驚訝，不小心大叫出聲：</p>
            
            <p>「詹⋯⋯詹姆士？你怎麼⋯⋯」</p>
            
            <p>詹姆士詭異的笑了笑，迅速用他長得像枯葉的雙手撥開草叢，叫兩隻獨角仙把維金斯斯壓住，並用巨大的棕色膠帶捆起來，丟進了螢火蟲小姐所在的狹小地下室。</p>
            
            <p>接著詹姆士和另外兩隻獨角仙沿著樹枝梯子一個個爬下來，並告訴維金斯和螢火蟲小姐：</p>
            
            <p>「我們是因為想要得到螢火蟲小姐龐大的財產，因為我們發現了維金斯的敏銳觀察力，對我們的計劃會有影響，所以我假扮成昆蟲間諜，騙維金斯去解決螢火蟲小姐的綁架案，讓維金斯的自信又減少，好讓兩隻獨角仙能順利地執行計劃，我們沒想到維金斯失去的自信會那麼快的變回來，但現在我們還是贏定啦！」</p>
            
            <p>下一秒，其中一隻比較黑，也比較高大的獨角仙把螢火蟲小姐抱出地下室，詹姆士和另一隻獨角仙也跟在後面。</p>
            
            <p>維金斯扯著喉嚨大聲道：</p>
            
            <p>「我才不會讓壞蟲得逞！」</p>
            
            <p>維金斯再也無法忍受詹姆士是冒牌貨，甚至還把它用綁起來這個騙局，想要努力打敗這些可惡的壞蟲，於是，他吃力的用兩隻沒被膠帶捆著的腳爬到梯子邊，想要用大鄂把他們撞下來，但他們用翅膀飛了起來，正當維金斯想要放棄時，那兩隻獨角仙一隻飛到維金斯身邊，幫他把身上的膠帶用角割開，讓維金斯了身體獲得自由。</p>
            
            <p>隨後，另一隻獨角仙衝到維金斯面前，並用他的角一再用力的撞詹姆士，一隻叫馬修的獨角仙邊戰鬥邊告訴維金斯他們就是被詹姆士關進監獄的那兩隻強盜獨角仙，前幾天才被放出來，但真正的強盜是詹姆士，詹姆士誣賴他們，讓他們兩個背黑鍋，維金斯知道後馬上轉身背對詹姆士，試著用刺眼的反光干擾詹姆士，維金斯試了很多次不同的角落，但不是照到詹姆士的腳，就是照的牆壁或梯子，但維金斯沒有放棄，他不段是了好幾個角度，終於，在詹姆士要砍斷另一隻叫傑夫的獨角仙的腳前一秒，維金斯成功用刺眼的反光照到了詹姆士的雙眼，詹姆士「啊！」的大叫一聲，摀著眼睛倒在地板上，傑夫和馬修趕緊衝過去，把詹姆士壓制住，最後，馬修和傑夫幫忙把詹姆士抬到警局，詹姆士被關進監獄，維金斯幫助螢火蟲小姐解開膠帶後，馬修、傑夫，還有維金斯被正式邀請成為昆蟲間諜，成為了在昆蟲間諜界最知名的昆蟲間諜搭檔。</p>
        </div>
    </div>

    <script>
        // 互動功能腳本
        
        // 1. 切換主題
        function setTheme(themeName) {
            document.body.setAttribute('data-theme', themeName);
        }

        // 2. 調整字體大小
        let currentFontSize = 14; // 更新預設為 14pt
        function changeFontSize(delta) {
            currentFontSize += delta;
            // 限制字體大小範圍 (10pt - 24pt)
            if (currentFontSize < 10) currentFontSize = 10;
            if (currentFontSize > 24) currentFontSize = 24;
            
            document.documentElement.style.setProperty('--font-size-base', currentFontSize + 'pt');
        }

        // 3. 閱讀進度條監聽
        window.addEventListener('scroll', () => {
            const scrollTop = document.documentElement.scrollTop || document.body.scrollTop;
            const scrollHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            const scrolled = (scrollTop / scrollHeight) * 100;
            document.getElementById('progress-bar').style.width = scrolled + '%';
        });

        // 4. 恢復預設值
        function resetDefaults() {
            // 重置字體大小
            currentFontSize = 14;
            document.documentElement.style.setProperty('--font-size-base', currentFontSize + 'pt');
            
            // 重置主題 (移除 data-theme 屬性即回到預設)
            document.body.removeAttribute('data-theme');
        }
    </script>
</body>
</html>

